{% extends 'base.html' %}
{% block title %}Home{% endblock %}
{% block extrahead %}
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
{% endblock %}
{% block content %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'home/stylehome.css' %}">
    <style media="screen">

    /* Extra CSS for Dynamic UseOnly */


    </style>
    <script type="text/javascript">
    function showWholeContent(id){
      var post = document.getElementById(id);
      post.style.height= "auto";
    }

    function likingPost(id){
      var liked = document.getElementById(id);
      liked.style.background = "rgb(34, 233, 42)";
    }
    </script>
    {% if user.is_authenticated %}
    <div class="panel">
      <div class="posts-container">
        <!-- ======================================================= -->
        {% for post in all_posts %}
          <div class="posts" id="post-{{ post.id }}">
            <div class="post-header">
              <img src="{% static 'home/images/default-profile.png'%}" class="profile-pic" alt="" />
              <h3 class="user-name">{{ post.user_profile }}</h3><span class="level">{{ post.user_profile.level }}</span>
              <span class="date">{{ post.creation_time }}</span>
            </div>
            <h2 class="thought-title">{{ post.title }}</h2>
            <p class="content" id="{{ post.id }}" onclick="showWholeContent({{ post.id }})">
              {{ post.content }}
            </p>
            <div class="post-footer">
              <form id="like-form{{ post.id }}">
                {% csrf_token %}
                <button type="submit" id="{{ post.id }}btn" name="like" value="{{ post.id }}" class="btn upvote">Like</button>
                <script type="text/javascript">
                  {% for like in post.likes.all %}
                    {% if like != user %}

                    {% else %}
                      likingPost("{{ post.id }}btn");
                    {% endif %}
                  {% endfor %}

      // Adding AJAX for Like button
                  $(document).ready(function(event){
                    $(document).on('click', '#{{ post.id }}btn', function(event){
                      event.preventDefault();

                      $.ajax({
                        type: 'POST',
                        url: '{% url "like_post" %}',
                        data: {
                          'id': '{{ post.id }}',
                          csrfmiddlewaretoken: '{{ csrf_token }}'
                        },

                        success:function(response){
                          
                        }
                      });
                    });
                  });

                </script>
              </form>
              <button type="button" name="button" class="btn upvote">Down vote</button>
              <form action="target" class="comment-form">
                <input type="text" name="comment" placeholder="Comment">
                <button type="submit" class="btn comment-submit">
                  <i class="fa fa-arrow-circle-right fa-lg"></i>
                </button>
              </form>
            </div>
          </div>
        {% endfor %}
        <!-- ============================================================= -->


      </div>
      <div class="following-container">
        <div class="following-box">
          <h3 class="box-header">Popular Thinkers</h3>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>
        </div>
        <div class="mathch-box">
          <h3 class="box-header">Your Followings</h3>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>
          <a href="#">
            <div class="following">
              <img src="{% static 'home/images/default-profile.png'%}" alt="" class="following-profile">
              <h3 class="user-name-profile">User Name</h3>
            </div>
          </a>

        </div>
      </div>
    </div>
    {% else %}
      <h2>You are not logged In. Click <a href="{% url 'login' %}">here</a> to login to Toob</h2>
    {% endif %}
    <script type="text/javascript">

    </script>


{% endblock %}
